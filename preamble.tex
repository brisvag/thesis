% different stuff if printer-friendly or not
\RequirePackage{xifthen} \newboolean{printer-friendly} \setboolean{printer-friendly}{false}

% TODO: move to memoir (requires lots of fixes)
\ifthenelse{\boolean{printer-friendly}}{
    \documentclass[8pt,a5paper]{extbook} % extbook to allow smaller font
    \usepackage[twoside=true]{geometry} % twoside for book binding
}{
    \documentclass[12pt,a4paper]{extbook}
    \usepackage[twoside=false]{geometry}
}

% general must-have or good-to-have stuff
\usepackage[english]{babel}
\usepackage{microtype} % fixes some over/under-full box warnings
\usepackage[T1]{fontenc} % better behaviour for fonts (copy-pasting, etc)
\usepackage{XCharter} % font typeface (compared to charter has support for unicode input/output)
\usepackage{setspace} \onehalfspacing % use stuff like \onehalfspacing and \begin{singlespace}

% bibliography
\usepackage[super,sort&compress,comma]{natbib}
\bibliographystyle{unsrtnat}
\def\bibfont{\footnotesize}

% hyperrefs and friends
\ifthenelse{\boolean{printer-friendly}}{
    \usepackage[pagebackref,breaklinks,hidelinks]{hyperref}
}{
    \usepackage[pagebackref,breaklinks,colorlinks,linkcolor=blue,citecolor=blue,urlcolor=cyan]{hyperref}
}
\urlstyle{same} % don't use monospace font for urls
\renewcommand*\backref[1]{\ifx#1\relax \else (pg. #1) \fi} % backref to citation location formatted as: (pg. N)
\usepackage{hypernat} % fixes backref of ranges. must be after natbib and hyperref
\ifthenelse{\boolean{printer-friendly}}{}{
    \newcommand*{\doi}[1]{\href{https://doi.org/\detokenize{#1}}{DOI:~\detokenize{#1}}} % hyperlink DOIs (only non-print)
}
% "fullref" (especially for printed cause link can't be clicked and it's easier to find with section numbers)
\newcommand*\fullref[1]{\hyperref[{#1}]{\bfseries\ref*{#1}: \nameref*{#1}}}

% useful miscellaneous
\usepackage{xcolor} % colors by name and modifiers to alpha and such
\usepackage{pdfpages} % include pre-rendered pdfs
\usepackage{tocbibind} % add lof and lot to toc
\usepackage[titles]{tocloft} % fix formatting issues with etoc and 3-digit page numbers in TOC
\usepackage{etoc} % local TOCs per-chapter
\usepackage{bookmark} % allow to end parts/sections (\startatroot}
\usepackage{booktabs} % improved tables
\usepackage{tabularx} % improved tables
\usepackage[section]{placeins} % float barriers with \FloatBarrier
\usepackage{enumitem} % remove item separation with [noitemsep]
\usepackage[perpage, symbol*]{footmisc} % footnotes counters use symbols and reset each page
\usepackage{amsmath,amssymb} % for better math symbols
\usepackage{epigraph} \setlength{\epigraphwidth}{.7\textwidth} \renewcommand\textflush{flushright} % cool quotes

% figures and captions
\usepackage{graphicx} \graphicspath{{img/}}
\usepackage[format=plain,labelfont={sc,bf},labelsep=endash,textfont={color=black!80},font=footnotesize]{caption}
\usepackage{subcaption} % subfigures

% code boxes and frames
\usepackage{minted} % syntax highlighting
\usepackage[nobreak]{mdframed} % framing minted boxes
\surroundwithmdframed[backgroundcolor=black!10]{minted}
% \setminted[python]{linenos} % enable line numbers on all python boxes

% other (order matters...)
\usepackage[autostyle,english=american]{csquotes} \MakeOuterQuote{"} % normal-er quotes (must be after minted)

% situational but useful or cool
% \usepackage{xspace} % smart spaces after commands % \newcommand*{\something}{\textit{SomEthing}\xspace}
% \usepackage{titling} % multiple/different title pages
% \usepackage[blocks]{authblk} \renewcommand\Affilfont{\scriptsize} % multiple authors with affiliations (must import after titling if it's there)
% \usepackage{tcolorbox} % colored titled box (e.g: "NOTE: ...")

% TODO: to remove, temporary packages
\usepackage{outlines} % easy nested lists
\usepackage{pifont} \newcommand{\tick}{\ding{51}} % icons (e.g checkmark)

% tikz stuff
\usepackage{tikz} \usetikzlibrary{positioning,shapes.geometric,arrows,fit}
\tikzstyle{node} = [
    rectangle,
    rounded corners,
    minimum width=15ex,
    minimum height=6ex,
    text centered,
    draw=black,
    fill=brown!20,
    scale=.7,
]
\tikzstyle{opt} = [node, ellipse, dashed]
\tikzstyle{dummy} = [node, draw=transparent!0, fill=transparent!0]
\tikzstyle{arrow} = [thick,->,>=stealth]

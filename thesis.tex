\input{preamble.tex}

\begin{document}

% preamble-like things that need to be after \begin{document} because reasons??
\ifthenelse{\boolean{printer-friendly}}{
    % convert href (which normally hides url with text) to a footnote so you can see it
    \let\oldhref\href\ \renewcommand\href[2]{\oldhref{#1}{#2}\footnote{\url{#1}}}
}{}

% smart caption that uses TOC title to add in bold at beginning, if given
\newcommand\titledcaption[2][]{
    \ifthenelse{\isempty{#1}}
        {\caption{#2}}
        {\caption[#1]{\textbf{#1.} #2}}
}


\frontmatter \pagenumbering{Roman}  % versus "roman" which is lowercase numerals
    \include{cover_title.tex}
    \ifthenelse{\boolean{printer-friendly}}{\newpage\mbox{}\newpage}{} % blank page only in printer-friendly
    \epigraph{-}{-}  % TODO: dedication or cool quote
    % \epigraph{The place they go towards is a place even less imaginable to most of us than the city of happiness. I cannot describe it at all. It is possible that it does not exist. But they seem to know where they are going, the ones who walk away from Omelas.}{\textit{The ones who walk away from Omelas} --- \textbf{Ursula K. Le Guin}}
    \include{abstract.tex}
    \include{acknowledgements.tex}
    \include{preface.tex}
    \etocsettocdepth{1} \tableofcontents \etocsettocdepth{all}

\mainmatter
    \part{Introduction}\label{introduction}
        \include{cryo_em.tex}
        \include{cryo_et.tex}
    \part{Results}\label{results}
        \include{blik.tex}
        \include{drad.tex}
        \include{other_projects.tex}
    \part{Discussion}\label{discussion}
        \include{em_software.tex}
        \include{future.tex}

\backmatter
    \bookmarksetup{startatroot}  % end \part in the bookmarks
    \listoffigures
    \listoftables
    \include{glossary.tex}
    \bibliography{./bibliography.bib}
    % \bookmarksetup{startatroot}  % end \chapter in the bookmarks
    % \include{endnote.tex}

\end{document}

% TODO: add captions to drad paper!
% TODO: make sure chapter have short names for the header and TOCs in []
% TODO: same thing as above but for figures
% TODO: add CV at the end?
% TODO: take care of all the overfull/underfull nonsense
% TODO: add quotes for chapters/sections
% TODO: check spelling and maybe run a grammar/syntax checker too.
% TODO: add code to generate figures when possible
% TODO: check all figures are referenced in text
% TODO: check use of nameref/autoref is consistent (use fullref!)
% TODO: section title case consistency
% TODO: check that first appearance of acronyms is explained (cryo-et/em, spa, sta, ...)
% TODO: check that micro/mu and other weird chars are fine!!!
% TODO: adjust figures in drad paper if there's time...
% TODO: make sure figures are appearing at the right place! Resize if necessary, or add float barriers.
% TODO: update thesis title on ADUM (and french version...)
% TODO: remove list of tables if nothing's there...
% TODO: make sure all figs use \titledcaption and not just \caption (except subfigures)
% TODO: convert svg to nice ones and commit to repo!
% TODO: make repo public, add endnote mentioning it, with license?
% TODO: use generate bibliography instead of zotero library and commit to repo
